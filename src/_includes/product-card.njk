{# PRODUCT CARD - The Repeatable Vessel #}
{# 
  Usage: {% include "product-card.njk", product: productObject %}
  
  Expected product structure:
  {
    name: string,
    price: number,
    compressed: string (one-breath description),
    liveUrl: string (optional),
    features: array of strings,
    category: "software" | "music" | "bundle"
  }
#}

<div class="product-card">
  
  {# Card Header #}
  <div class="card-header">
    <h3 class="card-title">{{ product.name }}</h3>
    {% if product.free %}
    <p class="card-price" style="color: var(--primary); font-weight: 700;">100% FREE</p>
    {% else %}
    <p class="card-price">{{ product.price | currency }}</p>
    {% endif %}
  </div>

  <div class="pre-sale-badge">Live Tool • Ready to Use</div>
  
  {# Compressed Description - One Breath #}
  <p class="card-compressed">{{ product.compressed }}</p>
  
  {# Video Walkthrough Embed (if available) #}
  {% if product.videoUrl %}
  <div class="product-video-wrapper">
    <iframe 
      width="100%" 
      height="200" 
      src="https://www.youtube.com/embed/{{ product.videoUrl | replace('https://youtu.be/', '') }}" 
      title="Product Demo Video" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen>
    </iframe>
  </div>
  {% endif %}
  
  {# Features - Pattern Recognition #}
  {% if product.features %}
  <ul class="card-features">
    {% for feature in product.features %}
    <li>{{ feature }}</li>
    {% endfor %}
  </ul>
  {% endif %}
  
  {# CTAs - Transformation Points #}
  <div class="card-actions">

    {# Free Tools - Link to Dashboard #}
    {% if product.toolUrl %}
    <a href="{{ product.toolUrl }}" class="cta-button">
      Explore Tool →
    </a>
    {% elif product.free and product.category == "software" %}
    <a href="/tools/" class="cta-button">
      View Tools Hub →
    </a>

    {# Paid Products - Keep Original Flow #}
    {% elif product.stripeUrl %}
    <a href="{{ product.stripeUrl }}" class="cta-button">
      Get Now – {{ product.price | currency }}
    </a>
    {% else %}
    <a href="/contact/?product={{ product.name | urlencode }}" class="card-button-primary">
      Get {{ product.name }}
    </a>
    {% endif %}

  </div>
  
</div>
